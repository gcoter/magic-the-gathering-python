schema: '2.0'
stages:
  collect_data:
    cmd: "python scripts/run_competition_between_players.py --n_games 1000 --player_classes
      random,random --params_path params.yaml --game_logs_dataset_path data/game_logs_dataset.pickle
      --metrics_json_path results/metrics/collect_data.json\n"
    deps:
    - path: data/basic_land_cards.csv
      md5: 64b65f2ffffe186aa55a8b32b77647e8
      size: 497714
    - path: data/vanilla_creature_cards.csv
      md5: 954695af44c0a4041cca760fd8134d49
      size: 138286
    - path: magic_the_gathering/actions/
      md5: 9df938a70d002d12cb91f98b773a2a22.dir
      size: 59737
      nfiles: 31
    - path: magic_the_gathering/cards/
      md5: c9c378010358284cb5af93d18e9fa643.dir
      size: 25071
      nfiles: 8
    - path: magic_the_gathering/game_engine.py
      md5: ccbfe8906bee120793fc5e989ddc2443
      size: 1758
    - path: magic_the_gathering/game_logs_dataset.py
      md5: 30fd4062fb2332e7587b3cf89abb6c48
      size: 3765
    - path: magic_the_gathering/game_modes/
      md5: 0ddb7cb1fde81ef7f49487bc1fddb935.dir
      size: 2301
      nfiles: 6
    - path: magic_the_gathering/game_state.py
      md5: 1fed89061b3fc30f03592d4bce8eb371
      size: 10443
    - path: magic_the_gathering/phases/base.py
      md5: 53629da810f5b243262bbf8e3de5a227
      size: 602
    - path: magic_the_gathering/phases/beginning.py
      md5: c15c1816223f015feb9562a3de4a0c5b
      size: 824
    - path: magic_the_gathering/phases/combat_beginning.py
      md5: 3fa5df67e941c7dc539352764eea6600
      size: 383
    - path: magic_the_gathering/phases/combat_damage.py
      md5: fef49b4aad68eadaf0a1bec13265b79e
      size: 634
    - path: magic_the_gathering/phases/combat_declare_attackers.py
      md5: dfc37bf6948e4ab8d77a2daf9b99abfa
      size: 2064
    - path: magic_the_gathering/phases/combat_declare_blockers.py
      md5: 805f5b47b9054092b73bf8e6f3e8a6a5
      size: 2961
    - path: magic_the_gathering/phases/combat_end.py
      md5: 58899289bd65758b372cd8c27322f7ee
      size: 491
    - path: magic_the_gathering/phases/draw.py
      md5: a6e15eda17557361aa0c597fdeb04b95
      size: 516
    - path: magic_the_gathering/phases/end.py
      md5: ece917b39b89264c6b1832883f47f64d
      size: 906
    - path: magic_the_gathering/phases/main.py
      md5: a2964322eea3a368bb6db562dfb3a86a
      size: 2565
    - path: magic_the_gathering/phases/mulligan.py
      md5: d6f9ee42ec8193f1c3596aefae361f35
      size: 2269
    - path: magic_the_gathering/phases/players_get_priority.py
      md5: f729e8ef9eff2041e63c0523318395aa
      size: 654
    - path: magic_the_gathering/phases/untap.py
      md5: 6c1b40ba388a9d8deb71b6d88fe1a8ed
      size: 437
    - path: magic_the_gathering/phases/upkeep.py
      md5: 15af8bfbff635d7bd11713718fb1e346
      size: 327
    - path: magic_the_gathering/players/base.py
      md5: e1f9018c35626872fa56a441cdf76a14
      size: 2665
    - path: magic_the_gathering/players/random.py
      md5: 33c63d1d7888c7877b4f5c8200b4619e
      size: 368
    - path: magic_the_gathering/turn.py
      md5: db8503ace93b2a3760baf818c00a2ffc
      size: 2016
    - path: scripts/run_competition_between_players.py
      md5: 4cc1bb16305b0de7851ce030a300fa6d
      size: 6488
    outs:
    - path: data/game_logs_dataset.pickle
      md5: 43b60bbedcbc40a86e8e0c3f6fde6d68
      size: 3104208439
    - path: results/metrics/collect_data.json
      md5: 5bc0551b74a8f13d5cf4387151f1749f
      size: 176
  train_deep_learning_scorer:
    cmd: "python scripts/train_deep_learning_scorer.py --params_path params.yaml --game_logs_dataset_path
      data/game_logs_dataset.pickle --model_folder_path results/models/ --model_file_name
      deep_learning_scorer\n"
    deps:
    - path: data/game_logs_dataset.pickle
      md5: 43b60bbedcbc40a86e8e0c3f6fde6d68
      size: 3104208439
    - path: magic_the_gathering/game_logs_dataset.py
      md5: 30fd4062fb2332e7587b3cf89abb6c48
      size: 3765
    - path: magic_the_gathering/players/deep_learning_based/single_action_scorer/dataset.py
      md5: a5a0051d6ce476719f8b5671e2a53e2c
      size: 8545
    - path: 
        magic_the_gathering/players/deep_learning_based/single_action_scorer/models/base.py
      md5: e0921c27518a0a9c2f9ffb760b79a2c4
      size: 5820
    - path: 
        magic_the_gathering/players/deep_learning_based/single_action_scorer/models/v2.py
      md5: cf859820ebf37928fd0f909f9894c6c6
      size: 14465
    - path: scripts/train_deep_learning_scorer.py
      md5: 193b3d4b7dcdb3e4242b0fd279e33806
      size: 4741
    params:
      params.yaml:
        deep_learning_scorer:
          hyper_parameters:
            game_state_global_dim: 2
            n_players: 2
            player_dim: 8
            max_n_zone_vectors: 120
            zone_vector_dim: 34
            action_general_dim: 31
            max_n_action_source_cards: 10
            max_n_action_target_cards: 10
            embedding_dim: 64
            transformer_n_layers: 4
            transformer_n_heads: 8
            transformer_dim_feedforward: 128
            dropout: 0.1
          training:
            random_split:
              training_size: 0.8
              validation_size: 0.2
            batch_size: 100
            n_epochs: 1000
            model_checkpoint:
              monitor: validation_loss
              mode: min
              save_top_k: 1
              verbose: false
            early_stopping:
              monitor: validation_loss
              mode: min
              patience: 10
              verbose: false
    outs:
    - path: results/models//deep_learning_scorer.ckpt
      md5: d9a52a16726afd2cf7214f094ab62019
      size: 3450509
  evaluate_deep_learning_player:
    cmd: "python scripts/run_competition_between_players.py --n_games 1000 --player_classes
      random,deep_learning --params_path params.yaml --metrics_json_path results/metrics/evaluate_deep_learning_player.json
      --deep_learning_scorer_path results/models//deep_learning_scorer.ckpt\n"
    deps:
    - path: data/basic_land_cards.csv
      md5: 64b65f2ffffe186aa55a8b32b77647e8
      size: 497714
    - path: data/vanilla_creature_cards.csv
      md5: 954695af44c0a4041cca760fd8134d49
      size: 138286
    - path: magic_the_gathering/actions/
      md5: 9df938a70d002d12cb91f98b773a2a22.dir
      size: 59737
      nfiles: 31
    - path: magic_the_gathering/cards/
      md5: c9c378010358284cb5af93d18e9fa643.dir
      size: 25071
      nfiles: 8
    - path: magic_the_gathering/game_engine.py
      md5: ccbfe8906bee120793fc5e989ddc2443
      size: 1758
    - path: magic_the_gathering/game_logs_dataset.py
      md5: 30fd4062fb2332e7587b3cf89abb6c48
      size: 3765
    - path: magic_the_gathering/game_modes/
      md5: 0ddb7cb1fde81ef7f49487bc1fddb935.dir
      size: 2301
      nfiles: 6
    - path: magic_the_gathering/game_state.py
      md5: 1fed89061b3fc30f03592d4bce8eb371
      size: 10443
    - path: magic_the_gathering/phases/base.py
      md5: 53629da810f5b243262bbf8e3de5a227
      size: 602
    - path: magic_the_gathering/phases/beginning.py
      md5: c15c1816223f015feb9562a3de4a0c5b
      size: 824
    - path: magic_the_gathering/phases/combat_beginning.py
      md5: 3fa5df67e941c7dc539352764eea6600
      size: 383
    - path: magic_the_gathering/phases/combat_damage.py
      md5: fef49b4aad68eadaf0a1bec13265b79e
      size: 634
    - path: magic_the_gathering/phases/combat_declare_attackers.py
      md5: dfc37bf6948e4ab8d77a2daf9b99abfa
      size: 2064
    - path: magic_the_gathering/phases/combat_declare_blockers.py
      md5: 805f5b47b9054092b73bf8e6f3e8a6a5
      size: 2961
    - path: magic_the_gathering/phases/combat_end.py
      md5: 58899289bd65758b372cd8c27322f7ee
      size: 491
    - path: magic_the_gathering/phases/draw.py
      md5: a6e15eda17557361aa0c597fdeb04b95
      size: 516
    - path: magic_the_gathering/phases/end.py
      md5: ece917b39b89264c6b1832883f47f64d
      size: 906
    - path: magic_the_gathering/phases/main.py
      md5: a2964322eea3a368bb6db562dfb3a86a
      size: 2565
    - path: magic_the_gathering/phases/mulligan.py
      md5: d6f9ee42ec8193f1c3596aefae361f35
      size: 2269
    - path: magic_the_gathering/phases/players_get_priority.py
      md5: f729e8ef9eff2041e63c0523318395aa
      size: 654
    - path: magic_the_gathering/phases/untap.py
      md5: 6c1b40ba388a9d8deb71b6d88fe1a8ed
      size: 437
    - path: magic_the_gathering/phases/upkeep.py
      md5: 15af8bfbff635d7bd11713718fb1e346
      size: 327
    - path: magic_the_gathering/players/base.py
      md5: e1f9018c35626872fa56a441cdf76a14
      size: 2665
    - path: magic_the_gathering/players/deep_learning_based/base_scorer.py
      md5: 061962c74002d34e75e0720d62ff5fbc
      size: 398
    - path: magic_the_gathering/players/deep_learning_based/player.py
      md5: 5006a18ea7c9d33947e84100c41f68b8
      size: 1307
    - path: magic_the_gathering/players/deep_learning_based/single_action_scorer/dataset.py
      md5: a5a0051d6ce476719f8b5671e2a53e2c
      size: 8545
    - path: 
        magic_the_gathering/players/deep_learning_based/single_action_scorer/models/base.py
      md5: e0921c27518a0a9c2f9ffb760b79a2c4
      size: 5820
    - path: 
        magic_the_gathering/players/deep_learning_based/single_action_scorer/models/v2.py
      md5: cf859820ebf37928fd0f909f9894c6c6
      size: 14465
    - path: magic_the_gathering/turn.py
      md5: db8503ace93b2a3760baf818c00a2ffc
      size: 2016
    - path: results/models//deep_learning_scorer.ckpt
      md5: d9a52a16726afd2cf7214f094ab62019
      size: 3450509
    - path: scripts/run_competition_between_players.py
      md5: 4cc1bb16305b0de7851ce030a300fa6d
      size: 6488
    params:
      params.yaml:
        deep_learning_scorer:
          hyper_parameters:
            game_state_global_dim: 2
            n_players: 2
            player_dim: 8
            max_n_zone_vectors: 120
            zone_vector_dim: 34
            action_general_dim: 31
            max_n_action_source_cards: 10
            max_n_action_target_cards: 10
            embedding_dim: 64
            transformer_n_layers: 4
            transformer_n_heads: 8
            transformer_dim_feedforward: 128
            dropout: 0.1
          training:
            random_split:
              training_size: 0.8
              validation_size: 0.2
            batch_size: 100
            n_epochs: 1000
            model_checkpoint:
              monitor: validation_loss
              mode: min
              save_top_k: 1
              verbose: false
            early_stopping:
              monitor: validation_loss
              mode: min
              patience: 10
              verbose: false
    outs:
    - path: results/metrics/evaluate_deep_learning_player.json
      md5: 1e918f82ff828846609b944b36dde571
      size: 178
  compute_game_logs_stats:
    cmd: "python scripts/compute_game_logs_stats.py --game_logs_dataset_path data/game_logs_dataset.pickle
      --metrics_json_path results/metrics/game_logs_stats.json\n"
    deps:
    - path: data/game_logs_dataset.pickle
      md5: 43b60bbedcbc40a86e8e0c3f6fde6d68
      size: 3104208439
    - path: magic_the_gathering/actions/base.py
      md5: d62482db18bc7681547077c51d7015c2
      size: 5693
    - path: magic_the_gathering/game_logs_dataset.py
      md5: 30fd4062fb2332e7587b3cf89abb6c48
      size: 3765
    - path: scripts/compute_game_logs_stats.py
      md5: d77864575d8698ec8ee5966b3445feb0
      size: 2568
    outs:
    - path: results/metrics/game_logs_stats.json
      md5: 7f87099caa44904e628a0fa0c0f7b173
      size: 427
